<% @page_title = "Current Status" %>

<div class="container">
  <h1>Current Status</h1>
  <ul>
    <h2><li>Pods</li></h2>
    <!-- podの状態 -->
    <% if @pods.count == 0 %>
      <div class="container">
        <p>対象が存在しません</p>
      </div>
    <% else %>
      <div class="table-responsive">
        <table class="table table-striped table-sm">
          <thead>
            <tr>
              <th>name</th>
              <th>status</th>
              <th>IP address</th>
            </tr>
          </thead>
          <tbody>
            <% @pods.each do |pod| %>
            <tr>
              <th><%= pod.metadata.name %></th> <!-- pod名 -->
              <th><%= pod.status.phase %></th> <!-- podの状態 -->
              <th><%= pod.status.podIP %></th> <!--podのIPアドレス -->
              <% end %>
            </tr>
          </tbody>
        </table>
      </div>
    <% end %>
    <!-- podの状態 ここまで -->
    <h2><li>Deployments</li></h2>
    <!-- deploymentの状態-->
    <% if @deployments.count == 0 %>
      <div class="container">
        <p>対象が存在しません</p>
      </div>
    <% else %>
    <div class="table-responsive">
      <table class="table table-striped table-sm">
        <thead>
          <tr>
            <th>Name</th>
            <th>Replicas</th>
            <th>Available Status</th>
            <th>Processing Status</th>
            <th></th>
          </tr>
        </thead>
        <tbody>
          <% @deployments.each do |deployment| %>
          <tr>
            <th><%= deployment.metadata.name %></th> <!-- deployment名 -->
            <th><%= deployment.status.replicas %></th> <!-- レプリカ数 -->
            <th><%= deployment.status.conditions[0].status %></th>
            <th><%= deployment.status.conditions[1].status %></th>
            <!-- 削除ボタン -->
            <th>
              <%= bootstrap_form_tag url: "/delete" do |f| %>
                <%= f.hidden_field "deployment", :value => "#{deployment.metadata.name}" %>
                <%= f.submit "Delete", :class => "btn  btn-primary btn-sm" %>
              <% end %>
            </th>
            <!-- 削除ボタン ここまで -->
          </tr>
          <% end %>
        </tbody>
      </table>
    </div>
    <% end %>
    <!-- deploymentの状態 ここまで -->
  </ul>
</div>
